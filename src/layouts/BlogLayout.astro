---
import BaseLayout from './BaseLayout.astro';
import Header from '@/components/layout/Header.astro';
import Footer from '@/components/layout/Footer.astro';
import { formatDate } from '@/utils/formatDate';
import { getReadingTime, formatReadingTime } from '@/utils/getReadingTime';
import type { CollectionEntry } from 'astro:content';

interface Props {
  post: CollectionEntry<'blog'>;
  content?: string;
}

const { post, content = '' } = Astro.props;
const { title, description, date, tags, author, coverImage } = post.data;
const readingTime = getReadingTime(content);
---

<BaseLayout
  title={title}
  description={description}
  image={coverImage}
  type='article'
  class='min-h-screen bg-white'
>
  <Header />

  <main class='container mx-auto px-4 py-8 max-w-4xl mt-16'>
    <article class='prose prose-lg mx-auto'>
      <!-- Article Header -->
      <header class='mb-8 text-center'>
        {
          coverImage && (
            <img
              src={coverImage}
              alt={title}
              class='w-full h-64 object-cover rounded-lg mb-6'
            />
          )
        }

        <h1 class='text-4xl font-bold text-gray-900 mb-4'>{title}</h1>

        <div class='flex items-center justify-center space-x-4 text-sm text-gray-500 mb-4'>
          <span>作者: {author}</span>
          <span>•</span>
          <time datetime={date.toISOString()}>
            {formatDate(date)}
          </time>
          <span>•</span>
          <span>{formatReadingTime(readingTime)}</span>
        </div>

        {
          tags && tags.length > 0 && (
            <div class='flex items-center justify-center space-x-2 mb-6'>
              {tags.map(tag => (
                <span class='px-3 py-1 bg-blue-100 text-blue-800 text-xs rounded-full'>#{tag}</span>
              ))}
            </div>
          )
        }

        <p class='text-xl text-gray-600'>{description}</p>
      </header>

      <!-- Article Content -->
      <div class='prose prose-lg max-w-none'>
        <slot />
      </div>
    </article>
  </main>

  <Footer />
</BaseLayout>
